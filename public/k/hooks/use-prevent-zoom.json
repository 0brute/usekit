{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "use-prevent-zoom",
  "type": "registry:hook",
  "title": "Use Prevent Zoom",
  "description": "Prevent zooming on touch devices with usePreventZoom, providing global and element-specific zoom control with advanced features.",
  "files": [
    {
      "path": "registry/hooks/use-prevent-zoom.ts",
      "content": "import * as React from \"react\"\n\nexport interface Options {\n  scroll?: boolean\n  keyboard?: boolean\n  pinch?: boolean\n  global?: boolean\n}\n\nexport interface Return {\n  disableGlobal: () => void\n  enableGlobal: () => void\n  isGlobalDisabled: boolean\n  disableForElement: (element: HTMLElement) => () => void\n  enableForElement: (element: HTMLElement) => void\n  toggleGlobal: () => void\n}\n\nexport const usePreventZoom = (options: Options = {}): Return => {\n  const {\n    scroll = true,\n    keyboard = true,\n    pinch = true,\n    global = false,\n  } = options\n\n  const [isGlobalDisabled, setIsGlobalDisabled] = React.useState(global)\n  const elementListenersRef = React.useRef<Map<HTMLElement, (() => void)[]>>(\n    new Map()\n  )\n\n  const handleGlobalKeydown = React.useCallback(\n    (e: KeyboardEvent) => {\n      if (\n        isGlobalDisabled &&\n        keyboard &&\n        e.ctrlKey &&\n        (e.key === \"+\" ||\n          e.key === \"-\" ||\n          e.key === \"=\" ||\n          e.key === \"0\" ||\n          [\"61\", \"107\", \"173\", \"109\", \"187\", \"189\", \"48\"].includes(\n            e.keyCode.toString()\n          ))\n      ) {\n        e.preventDefault()\n        e.stopPropagation()\n      }\n    },\n    [isGlobalDisabled, keyboard]\n  )\n\n  const handleGlobalWheel = React.useCallback(\n    (e: WheelEvent) => {\n      if (isGlobalDisabled && scroll && e.ctrlKey) {\n        e.preventDefault()\n        e.stopPropagation()\n      }\n    },\n    [isGlobalDisabled, scroll]\n  )\n\n  const handleGlobalTouchMove = React.useCallback(\n    (e: TouchEvent) => {\n      if (isGlobalDisabled && pinch && e.touches.length > 1) {\n        e.preventDefault()\n        e.stopPropagation()\n      }\n    },\n    [isGlobalDisabled, pinch]\n  )\n\n  const createElementKeydownHandler = React.useCallback(\n    (element: HTMLElement) => (e: KeyboardEvent) => {\n      if (\n        keyboard &&\n        e.ctrlKey &&\n        (e.key === \"+\" ||\n          e.key === \"-\" ||\n          e.key === \"=\" ||\n          e.key === \"0\" ||\n          [\"61\", \"107\", \"173\", \"109\", \"187\", \"189\", \"48\"].includes(\n            e.keyCode.toString()\n          ))\n      ) {\n        if (element.contains(e.target as Node)) {\n          e.preventDefault()\n          e.stopPropagation()\n        }\n      }\n    },\n    [keyboard]\n  )\n\n  const createElementWheelHandler = React.useCallback(\n    (element: HTMLElement) => (e: WheelEvent) => {\n      if (scroll && e.ctrlKey && element.contains(e.target as Node)) {\n        e.preventDefault()\n        e.stopPropagation()\n      }\n    },\n    [scroll]\n  )\n\n  const createElementTouchMoveHandler = React.useCallback(\n    (element: HTMLElement) => (e: TouchEvent) => {\n      if (pinch && e.touches.length > 1 && element.contains(e.target as Node)) {\n        e.preventDefault()\n        e.stopPropagation()\n      }\n    },\n    [pinch]\n  )\n\n  const disableGlobal = React.useCallback(() => {\n    setIsGlobalDisabled(true)\n  }, [])\n\n  const enableGlobal = React.useCallback(() => {\n    setIsGlobalDisabled(false)\n  }, [])\n\n  const toggleGlobal = React.useCallback(() => {\n    setIsGlobalDisabled((prev) => !prev)\n  }, [])\n\n  const enableForElement = React.useCallback((element: HTMLElement) => {\n    if (!element) {\n      console.warn(\"usePreventZoom: Invalid element provided\")\n      return\n    }\n\n    const cleanupFunctions = elementListenersRef.current.get(element)\n    if (cleanupFunctions) {\n      cleanupFunctions.forEach((cleanup) => cleanup())\n      elementListenersRef.current.delete(element)\n    }\n  }, [])\n\n  const disableForElement = React.useCallback(\n    (element: HTMLElement): (() => void) => {\n      if (!element) {\n        console.warn(\"usePreventZoom: Invalid element provided\")\n        return () => {}\n      }\n\n      enableForElement(element)\n\n      const keydownHandler = createElementKeydownHandler(element)\n      const wheelHandler = createElementWheelHandler(element)\n      const touchMoveHandler = createElementTouchMoveHandler(element)\n\n      element.addEventListener(\"keydown\", keydownHandler as EventListener)\n      element.addEventListener(\"wheel\", wheelHandler, { passive: false })\n      element.addEventListener(\"touchmove\", touchMoveHandler, {\n        passive: false,\n      })\n\n      const cleanupFunctions = [\n        () =>\n          element.removeEventListener(\n            \"keydown\",\n            keydownHandler as EventListener\n          ),\n        () => element.removeEventListener(\"wheel\", wheelHandler),\n        () => element.removeEventListener(\"touchmove\", touchMoveHandler),\n      ]\n\n      elementListenersRef.current.set(element, cleanupFunctions)\n\n      return () => enableForElement(element)\n    },\n    [\n      enableForElement,\n      createElementKeydownHandler,\n      createElementWheelHandler,\n      createElementTouchMoveHandler,\n    ]\n  )\n\n  React.useEffect(() => {\n    if (isGlobalDisabled) {\n      document.addEventListener(\"keydown\", handleGlobalKeydown)\n      document.addEventListener(\"wheel\", handleGlobalWheel, { passive: false })\n      document.addEventListener(\"touchmove\", handleGlobalTouchMove, {\n        passive: false,\n      })\n\n      return () => {\n        document.removeEventListener(\"keydown\", handleGlobalKeydown)\n        document.removeEventListener(\"wheel\", handleGlobalWheel)\n        document.removeEventListener(\"touchmove\", handleGlobalTouchMove)\n      }\n    }\n  }, [\n    handleGlobalKeydown,\n    handleGlobalWheel,\n    handleGlobalTouchMove,\n    isGlobalDisabled,\n  ])\n\n  React.useEffect(() => {\n    const elementListeners = elementListenersRef.current\n    return () => {\n      elementListeners.forEach((cleanupFunctions) => {\n        cleanupFunctions.forEach((cleanup) => cleanup())\n      })\n      elementListeners.clear()\n    }\n  }, [])\n\n  return {\n    disableGlobal,\n    enableGlobal,\n    isGlobalDisabled,\n    disableForElement,\n    enableForElement,\n    toggleGlobal,\n  }\n}\n",
      "type": "registry:hook"
    }
  ]
}
